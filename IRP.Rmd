---
title: "Integrative Research Project"
author: "Team 57"
date: "21-6-2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(plyr)
library(dplyr)
```

```{r}
dataframe <- read.csv("IRPdata.csv")[-c(2, 71),18:71]
df <- dataframe[dataframe$Q1 == "I Consent",]
df <- df[df$Q1.5 == "Yes, I do",]
df <- df[df$Q3 != "Other",]
df <- cbind(ID = 1:71, df)
df[df$ID==34, "Shopping_5"] <- "Somewhat disagree"
df <- df[df$Shopping_5 == "Somewhat disagree",]
df <- df %>% mutate_all(na_if,"")
df <- df[,-c(30)]
```

```{r}
# Dummy'ing the whole lot

## Q2
df$Q2[df$Q2 == "Female"]                     <- 0
df$Q2[df$Q2 == "Male"]                       <- 1
df$Q2[df$Q2 == "Non-binary / third gender"]  <- 2
df$Q2[df$Q2 == "Prefer not to say"]          <- 3


n <- c("Strongly Disagree"                   = 1, 
       "Disagree"                            = 2, 
       "Somewhat disagree"                   = 3, 
       "Neither agree nor disagree"          = 4, 
       "Somewhat agree"                      = 5, 
       "Agree"                               = 6, 
       "Strongly agree"                      = 7)

df$Cyberloafing_1D <- as.numeric(revalue(df$Cyberloafing_1, n))
df$Cyberloafing_2D <- as.numeric(revalue(df$Cyberloafing_2, n))
df$Cyberloafing_3D <- as.numeric(revalue(df$Cyberloafing_3, n))
df$Cyberloafing_4D <- as.numeric(revalue(df$Cyberloafing_4, n))
df$Cyberloafing_5D <- as.numeric(revalue(df$Cyberloafing_5, n))
df$Cyberloafing_6D <- as.numeric(revalue(df$Cyberloafing_6, n))
df$Cyberloafing_7D <- as.numeric(revalue(df$Cyberloafing_7, n))
df$Cyberloafing_8D <- as.numeric(revalue(df$Cyberloafing_8, n))
df$Cyberloafing_9D <- as.numeric(revalue(df$Cyberloafing_9, n))

df$Shopping_1D <- as.numeric(revalue(df$Shopping_1, n))
df$Shopping_2D <- as.numeric(revalue(df$Shopping_2, n))
df$Shopping_3D <- as.numeric(revalue(df$Shopping_3, n))
df$Shopping_4D <- as.numeric(revalue(df$Shopping_4, n))
df$Shopping_6D <- as.numeric(revalue(df$Shopping_6, n))
df$Shopping_7D <- as.numeric(revalue(df$Shopping_7, n))
df$Shopping_8D <- as.numeric(revalue(df$Shopping_8, n))

df$Access.Online.Conten_1D <- as.numeric(revalue(df$Access.Online.Conten_1, n))
df$Access.Online.Conten_2D <- as.numeric(revalue(df$Access.Online.Conten_2, n))
df$Access.Online.Conten_3D <- as.numeric(revalue(df$Access.Online.Conten_3, n))
df$Access.Online.Conten_4D <- as.numeric(revalue(df$Access.Online.Conten_4, n))
df$Access.Online.Conten_5D <- as.numeric(revalue(df$Access.Online.Conten_5, n))

m <- c("Never"         = 1,
       "Rarely"        = 2,
       "Sometimes"     = 3,
       "Often"         = 4,
       "Almost Always" = 5)

df$Productivity_1D <- as.numeric(revalue(df$Productivity_1, m))
df$Productivity_2D <- as.numeric(revalue(df$Productivity_2, m))
df$Productivity_3D <- as.numeric(revalue(df$Productivity_3, m))
df$Productivity_4D <- as.numeric(revalue(df$Productivity_4, m))
df$Productivity_5D <- as.numeric(revalue(df$Productivity_5, m))
df$Productivity_6D <- as.numeric(revalue(df$Productivity_6, m))
df$Productivity_7D <- as.numeric(revalue(df$Productivity_7, m))
df$Productivity_8D <- as.numeric(revalue(df$Productivity_8, m))
df$Productivity_9D <- as.numeric(revalue(df$Productivity_9, m))
df$Productivity_10D <- as.numeric(revalue(df$Productivity_10, m))
df$Productivity_11D <- as.numeric(revalue(df$Productivity_11, m))
df$Productivity_12D <- as.numeric(revalue(df$Productivity_12, m))
df$Productivity_13D <- as.numeric(revalue(df$Productivity_13, m))
df$Productivity_14D <- as.numeric(revalue(df$Productivity_14, m))
df$Productivity_15D <- as.numeric(revalue(df$Productivity_15, m))
df$Productivity_16D <- as.numeric(revalue(df$Productivity_16, m))
df$Productivity_17D <- as.numeric(revalue(df$Productivity_17, m))
```

```{r}
#Establish row means of each cyberloafing variable
df$SharingM <- rowMeans(df[,55:63], na.rm = T)
df$ShoppingM <- rowMeans(df[,64:70], na.rm = T)
df$AccessM <- rowMeans(df[,71:75], na.rm = T)
df$ProductivityM <- rowMeans(df[,76:92], na.rm = T)

#Cyberloafing as a whole
df$CyberM <- rowMeans(df[,55:75], na.rm = T)
```

```{r}
#Regression
lm1 <- lm(df$ProductivityM ~ CyberM + Q3)
lm2 <- lm(df$ProductivityM ~ CyberM + Q3 CyberM * Q3)
```
