---
title: "Integrative Research Project"
author: "Team 57"
date: "21-6-2021"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
dataframe <- read.csv("IRPdata.csv")[-c(2, 71),18:71]
df <- dataframe[dataframe$Q1 == "I Consent",]
df <- df[df$Q1.5 == "Yes, I do",]
df <- df[df$Q3 != "Other",]
df <- cbind(ID = 1:71, df)
df[df$ID==34, "Shopping_5"] <- "Somewhat disagree"
df <- df %>% mutate_all(na_if,"")
```

```{r}
# Dummy'ing the whole lot

## Q2
df$Q2[df$Q2 == "Female"] <- 0
df$Q2[df$Q2 == "Male"] <- 1
df$Q2[df$Q2 == "Non-binary / third gender"] <- 2
df$Q2[df$Q2 == "Prefer not to say"] <- 3


library(dplyr)
df %>% 
  mutate_at(vars(starts_with("Cyberloafing")), 
            funs("rc" = recode(.,
                               "Strongly Disagree"           = 1,
                               "Somewhat disagree"           = 2,
                               "Neither agree nor disagree"  = 3,
                               "Somewhat agree"              = 4,
                               "Agree"                       = 5)))
table(df$Cyberloafing_1)
```
```{r}
#Establish row means of each cyberloafing variable
df$SharingM <- rowMeans(df[,17:25], na.rm = T)
df$ShoppingM <- rowMeans(df[,26:33], na.rm = T)
df$AccessM <- rowMeans(df[,34:38], na.rm = T)
df$ProductivityM <- rowMeans(df[,39:55], na.rm = T)

#Cyberloafing as a whole
df$CyberM <- rowMeans(df[,17:38], na.rm = T)
```

```{r}
#Regression
lm1 <- lm(df$ProductivityM ~ CyberM + Q3)
lm2 <- lm(df$ProductivityM ~ CyberM + Q3 CyberM * Q3)
```
